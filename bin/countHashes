#!/usr/bin/awk -f

BEGIN {
    if (ARGV[1] ~ /^(--(help|man|usage)|-[Hh?])$/) {
	print "Condense subsequent #'s at the end of a line or if a $ sigil is following (###$)"
	print "into a count of those hashes."
	print ""
	print "Usage: countHashes FILE [...] [-?|-- -h|-H|--man|--usage]"
	print "Usage: cat FILE [...] | countHashes "
	isHelp = 1
	exit
    }
}
{
    while (match($0, /#+(\$|$)/)) {
	hashes = substr($0, RSTART, RLENGTH)
	if (substr(hashes, length(hashes)) == "$") {
	    hashes = substr(hashes, 1, length(hashes) - 1)
	}
	$0 = substr($0, 1, RSTART - 1) length(hashes) substr($0, RSTART + RLENGTH)
    }
    print
}
